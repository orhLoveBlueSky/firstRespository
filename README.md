# spring+springmvc+mybatis+redis+activeMQ+tomcat实现网上商城的前后端接口开发
1.用Redis+lua模拟用户抢红包；在高并发的抢红包场景下，需要保证抢红包的速度还不能出现超发现象；首先使用悲观锁，通过在select查询中加for update排他锁，查询红包库存，若还有库存则抢红包成功，否则失败，但出现了红包超发现象且抢红包的速度很慢；然后使用乐观锁，通过在数据库红包表加版本号，每次抢红包时若还有库存再比对版本号若与之前的一样，则抢红包成功，但抢红包的成功率低有大量红包剩余但无超发现象，针对成功率低的问题可以引入重入机制；最后使用redis，先在redis用hash数据结构存红包的信息，有红包的id和库存，抢红包时先访问tomcat再访问redis比对是否还有库存，若有则抢成功并在redis用list数据结构存进用户的信息，否则抢红包结束，并使用spring的异步方法将全部用户的信息持久化到mysql，这种方法速度快，且无超发现象
2.实现调用支付宝的当面付接口，模拟用户扫描二维码支付的操作；前台发起支付，调用支付的接口并传进订单号，根据订单号从数据库查询交易的商品信息，然后创建扫码支付builder向支付宝服务器发起支付请求，根据返回的状态用日志记录请求结果，支付宝服务器调用tomcat的支付宝回调接口，接口要验证回调的正确性，若异常则打印错误日志，否则还要验证支付宝是否重复调用，若重复调用，回调忽略，否则交易成功并向mysql持久化交易的信息
3.使用activeMQ实现用户手机验证码登录；先验证手机号码是否存在，若存在则调用后台获取验证码的接口并传进手机号码参数，服务器生成验证码并存在本地缓存同时设置失效时间，然后将短信内容和手机号码的信息发到activeMQ的队列中，activeMQ消费者消费消息期间调用253云通讯短信服务平台接口发送验证码短信到用户手机，用户须在指定时间内输入验证码登录,登陆过程将输入的验证码与缓存中的验证码对比，一样则登陆成功，否则登陆失败
4.完成前台接口（用户模块、抢红包模块、支付模块 、订单管理模块）的开发
5.完成后台接口（商品管理模块）的开发
